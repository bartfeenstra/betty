#!/usr/bin/env bash

set -Eeuo pipefail

cd "$(dirname "$0")/.."

# Download fileb0x.
mkdir -p ./build/go
FILEB0X_VERSION=v1.1.3
if [[ ! -d ./build/go/fileb0x ]]; then
    git clone https://github.com/UnnoTed/fileb0x.git ./build/go/fileb0x
fi
(
    cd ./build/go/fileb0x
    if ! git rev-parse "$FILEB0X_VERSION" >/dev/null 2>&1; then
        git fetch
    fi
    git checkout "$FILEB0X_VERSION"
)
./build/go/fileb0x/fileb0x b0x.yaml

# Download Bootstrap.

go build
