{% import 'macro/event.html.j2' as eventMacros %}
{% set person_context = person_context | default(none) %}
{% set dated_events = events | rejectattr('date', 'none') | selectattr('date.comparable') | sort(attribute='date') %}
{% if dated_events | length > 0 %}
    <ul class="entities">
        {% for event in dated_events %}
            <li class="{{ loop.cycle('odd', 'even') }}">
                {% include 'label/event.html.j2' %}
                {% if person_context is not none %}
                    {% for presence in event.presences %}
                        {% if person_context is defined and presence.person == person_context and presence.role != PresenceRole.SUBJECT %}
                            ({{ eventMacros.presence_role_label(presence.role) }})
                        {% endif %}
                    {% endfor %}
                {% endif %}
                {% include 'meta/event.html.j2' %}
            </li>
        {% endfor %}
    </ul>
{% endif %}
